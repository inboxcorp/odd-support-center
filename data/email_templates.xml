<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Appointment Confirmation Email Template -->
    <record id="email_template_appointment_confirmation" model="mail.template">
        <field name="name">Support Appointment Confirmation</field>
        <field name="model_id" ref="model_support_appointment"/>
        <field name="subject">Appointment Confirmation - ${object.name}</field>
        <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
        <field name="email_to">${object.customer_id.email}</field>
        <field name="lang">${object.customer_id.lang}</field>
        <field name="auto_delete" eval="True"/>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <div style="margin: 0px; padding: 0px; background-color: #f8f9fa; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: #555;">
        <table border="0" cellpadding="0" cellspacing="0" style="margin: auto; width: 600px; background-color: white;">
            <tbody>
                <!-- Header -->
                <tr>
                    <td align="center" style="background-color: #875A7B; padding: 20px 0;">
                        <h1 style="color: white; margin: 0; font-size: 24px;">
                            Support Appointment Confirmed
                        </h1>
                    </td>
                </tr>
                
                <!-- Body -->
                <tr>
                    <td style="padding: 30px;">
                        <div style="margin-bottom: 20px;">
                            <p>Dear ${object.customer_id.name},</p>
                            
                            <p>Your support appointment has been confirmed. Here are the details:</p>
                        </div>
                        
                        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Appointment Reference:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.name}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Date &amp; Time:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${format_datetime(object.scheduled_date, object.customer_id.tz or 'UTC', 'medium')}</td>
                            </tr>
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Duration:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.duration} hour(s)</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Technician:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.technician_id.name}</td>
                            </tr>
                            % if object.location:
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Location:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.location}</td>
                            </tr>
                            % endif
                            % if object.description:
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Notes:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.description}</td>
                            </tr>
                            % endif
                        </table>
                        
                        <div style="margin: 30px 0;">
                            <p><strong>What to expect:</strong></p>
                            <ul>
                                <li>Our technician will arrive at the scheduled time</li>
                                <li>Please ensure someone is available to provide access</li>
                                <li>Have any relevant information or equipment ready</li>
                            </ul>
                        </div>
                        
                        <div style="background-color: #e7f3ff; padding: 15px; border-left: 4px solid #2196F3; margin: 20px 0;">
                            <p style="margin: 0;"><strong>Need to reschedule or cancel?</strong></p>
                            <p style="margin: 5px 0 0 0;">Please contact us at least 24 hours in advance.</p>
                        </div>
                        
                        <p>If you have any questions, please don't hesitate to contact us.</p>
                        
                        <p>Best regards,<br/>
                        Support Team</p>
                    </td>
                </tr>
                
                <!-- Footer -->
                <tr>
                    <td style="background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 11px;">
                        <p style="margin: 0;">
                            ${object.company_id.name}<br/>
                            % if object.company_id.phone:
                            Phone: ${object.company_id.phone}<br/>
                            % endif
                            % if object.company_id.email:
                            Email: ${object.company_id.email}
                            % endif
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
        </field>
    </record>

    <!-- Appointment Reminder Email Template -->
    <record id="email_template_appointment_reminder" model="mail.template">
        <field name="name">Support Appointment Reminder</field>
        <field name="model_id" ref="model_support_appointment"/>
        <field name="subject">Reminder: Support Appointment Tomorrow - ${object.name}</field>
        <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
        <field name="email_to">${object.customer_id.email}</field>
        <field name="lang">${object.customer_id.lang}</field>
        <field name="auto_delete" eval="True"/>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <div style="margin: 0px; padding: 0px; background-color: #f8f9fa; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: #555;">
        <table border="0" cellpadding="0" cellspacing="0" style="margin: auto; width: 600px; background-color: white;">
            <tbody>
                <!-- Header -->
                <tr>
                    <td align="center" style="background-color: #FF9800; padding: 20px 0;">
                        <h1 style="color: white; margin: 0; font-size: 24px;">
                            ⏰ Appointment Reminder
                        </h1>
                    </td>
                </tr>
                
                <!-- Body -->
                <tr>
                    <td style="padding: 30px;">
                        <div style="margin-bottom: 20px;">
                            <p>Dear ${object.customer_id.name},</p>
                            
                            <p>This is a friendly reminder that you have a support appointment scheduled for tomorrow:</p>
                        </div>
                        
                        <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; padding: 20px; margin: 20px 0; border-radius: 5px;">
                            <h3 style="margin-top: 0; color: #856404;">Appointment Details</h3>
                            <p><strong>Reference:</strong> ${object.name}</p>
                            <p><strong>Date &amp; Time:</strong> ${format_datetime(object.scheduled_date, object.customer_id.tz or 'UTC', 'full')}</p>
                            <p><strong>Technician:</strong> ${object.technician_id.name}</p>
                            % if object.location:
                            <p><strong>Location:</strong> ${object.location}</p>
                            % endif
                            <p><strong>Duration:</strong> ${object.duration} hour(s)</p>
                        </div>
                        
                        <div style="margin: 30px 0;">
                            <p><strong>Preparation checklist:</strong></p>
                            <ul>
                                <li>✓ Ensure someone will be available at the scheduled time</li>
                                <li>✓ Prepare any relevant documentation or information</li>
                                <li>✓ Clear access to the equipment or area requiring service</li>
                                <li>✓ Note down any questions you'd like to ask the technician</li>
                            </ul>
                        </div>
                        
                        <div style="background-color: #f8d7da; padding: 15px; border-left: 4px solid #dc3545; margin: 20px 0;">
                            <p style="margin: 0;"><strong>Need to cancel or reschedule?</strong></p>
                            <p style="margin: 5px 0 0 0;">Please contact us immediately if you cannot make this appointment.</p>
                        </div>
                        
                        <p>We look forward to providing you with excellent service tomorrow!</p>
                        
                        <p>Best regards,<br/>
                        Support Team</p>
                    </td>
                </tr>
                
                <!-- Footer -->
                <tr>
                    <td style="background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 11px;">
                        <p style="margin: 0;">
                            ${object.company_id.name}<br/>
                            % if object.company_id.phone:
                            Phone: ${object.company_id.phone}<br/>
                            % endif
                            % if object.company_id.email:
                            Email: ${object.company_id.email}
                            % endif
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
        </field>
    </record>

    <!-- Appointment Reschedule Email Template -->
    <record id="email_template_appointment_reschedule" model="mail.template">
        <field name="name">Support Appointment Rescheduled</field>
        <field name="model_id" ref="model_support_appointment"/>
        <field name="subject">Appointment Rescheduled - ${object.name}</field>
        <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
        <field name="email_to">${object.customer_id.email}</field>
        <field name="lang">${object.customer_id.lang}</field>
        <field name="auto_delete" eval="True"/>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <div style="margin: 0px; padding: 0px; background-color: #f8f9fa; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: #555;">
        <table border="0" cellpadding="0" cellspacing="0" style="margin: auto; width: 600px; background-color: white;">
            <tbody>
                <!-- Header -->
                <tr>
                    <td align="center" style="background-color: #17a2b8; padding: 20px 0;">
                        <h1 style="color: white; margin: 0; font-size: 24px;">
                            📅 Appointment Rescheduled
                        </h1>
                    </td>
                </tr>
                
                <!-- Body -->
                <tr>
                    <td style="padding: 30px;">
                        <div style="margin-bottom: 20px;">
                            <p>Dear ${object.customer_id.name},</p>
                            
                            <p>Your support appointment has been rescheduled. Please note the new details below:</p>
                        </div>
                        
                        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Appointment Reference:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.name}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">New Date &amp; Time:</td>
                                <td style="padding: 10px; border: 1px solid #ddd; color: #17a2b8; font-weight: bold;">
                                    ${format_datetime(object.scheduled_date, object.customer_id.tz or 'UTC', 'full')}
                                </td>
                            </tr>
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Duration:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.duration} hour(s)</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Technician:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.technician_id.name}</td>
                            </tr>
                            % if object.location:
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Location:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.location}</td>
                            </tr>
                            % endif
                            % if ctx.get('reschedule_reason'):
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Reason:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${ctx['reschedule_reason']}</td>
                            </tr>
                            % endif
                        </table>
                        
                        <div style="background-color: #d1ecf1; padding: 15px; border-left: 4px solid #17a2b8; margin: 20px 0;">
                            <p style="margin: 0;"><strong>Important:</strong></p>
                            <p style="margin: 5px 0 0 0;">Please update your calendar with the new appointment time. We apologize for any inconvenience.</p>
                        </div>
                        
                        <div style="margin: 30px 0;">
                            <p><strong>What to expect:</strong></p>
                            <ul>
                                <li>Our technician will arrive at the new scheduled time</li>
                                <li>Please ensure someone is available to provide access</li>
                                <li>Have any relevant information or equipment ready</li>
                            </ul>
                        </div>
                        
                        <p>If you have any questions about this change or need to reschedule again, please contact us.</p>
                        
                        <p>Best regards,<br/>
                        Support Team</p>
                    </td>
                </tr>
                
                <!-- Footer -->
                <tr>
                    <td style="background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 11px;">
                        <p style="margin: 0;">
                            ${object.company_id.name}<br/>
                            % if object.company_id.phone:
                            Phone: ${object.company_id.phone}<br/>
                            % endif
                            % if object.company_id.email:
                            Email: ${object.company_id.email}
                            % endif
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
        </field>
    </record>

    <!-- Appointment Cancellation Email Template -->
    <record id="email_template_appointment_cancellation" model="mail.template">
        <field name="name">Support Appointment Cancelled</field>
        <field name="model_id" ref="model_support_appointment"/>
        <field name="subject">Appointment Cancelled - ${object.name}</field>
        <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
        <field name="email_to">${object.customer_id.email}</field>
        <field name="lang">${object.customer_id.lang}</field>
        <field name="auto_delete" eval="True"/>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <div style="margin: 0px; padding: 0px; background-color: #f8f9fa; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: #555;">
        <table border="0" cellpadding="0" cellspacing="0" style="margin: auto; width: 600px; background-color: white;">
            <tbody>
                <!-- Header -->
                <tr>
                    <td align="center" style="background-color: #dc3545; padding: 20px 0;">
                        <h1 style="color: white; margin: 0; font-size: 24px;">
                            ❌ Appointment Cancelled
                        </h1>
                    </td>
                </tr>
                
                <!-- Body -->
                <tr>
                    <td style="padding: 30px;">
                        <div style="margin-bottom: 20px;">
                            <p>Dear ${object.customer_id.name},</p>
                            
                            <p>We regret to inform you that your support appointment has been cancelled. Here are the details:</p>
                        </div>
                        
                        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Appointment Reference:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.name}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Original Date &amp; Time:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">
                                    ${format_datetime(object.scheduled_date, object.customer_id.tz or 'UTC', 'full')}
                                </td>
                            </tr>
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Technician:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.technician_id.name}</td>
                            </tr>
                            % if ctx.get('cancellation_reason'):
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Reason:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${ctx['cancellation_reason']}</td>
                            </tr>
                            % endif
                            % if ctx.get('cancellation_details'):
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Details:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${ctx['cancellation_details']}</td>
                            </tr>
                            % endif
                        </table>
                        
                        % if ctx.get('refund_required'):
                        <div style="background-color: #d4edda; padding: 15px; border-left: 4px solid #28a745; margin: 20px 0;">
                            <p style="margin: 0;"><strong>Refund Information:</strong></p>
                            <p style="margin: 5px 0 0 0;">A refund will be processed for this cancelled appointment. You will receive confirmation once the refund has been initiated.</p>
                        </div>
                        % endif
                        
                        <div style="background-color: #e2e3e5; padding: 15px; border-left: 4px solid #6c757d; margin: 20px 0;">
                            <p style="margin: 0;"><strong>What happens next:</strong></p>
                            <ul style="margin: 10px 0;">
                                <li>This appointment slot has been freed up</li>
                                <li>No further action is required from you</li>
                                % if not ctx.get('refund_required'):
                                <li>No charges will be applied for this cancellation</li>
                                % endif
                                <li>You can schedule a new appointment at any time</li>
                            </ul>
                        </div>
                        
                        <p>We sincerely apologize for any inconvenience this may cause. If you would like to reschedule or have any questions, please don't hesitate to contact us.</p>
                        
                        <p>Best regards,<br/>
                        Support Team</p>
                    </td>
                </tr>
                
                <!-- Footer -->
                <tr>
                    <td style="background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 11px;">
                        <p style="margin: 0;">
                            ${object.company_id.name}<br/>
                            % if object.company_id.phone:
                            Phone: ${object.company_id.phone}<br/>
                            % endif
                            % if object.company_id.email:
                            Email: ${object.company_id.email}
                            % endif
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
        </field>
    </record>

    <!-- Appointment Update Email Template -->
    <record id="email_template_appointment_update" model="mail.template">
        <field name="name">Support Appointment Updated</field>
        <field name="model_id" ref="model_support_appointment"/>
        <field name="subject">Appointment Updated - ${object.name}</field>
        <field name="email_from">${(object.company_id.email or user.email)|safe}</field>
        <field name="email_to">${object.customer_id.email}</field>
        <field name="lang">${object.customer_id.lang}</field>
        <field name="auto_delete" eval="True"/>
        <field name="body_html" type="html">
<div style="margin: 0px; padding: 0px;">
    <div style="margin: 0px; padding: 0px; background-color: #f8f9fa; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 12px; color: #555;">
        <table border="0" cellpadding="0" cellspacing="0" style="margin: auto; width: 600px; background-color: white;">
            <tbody>
                <!-- Header -->
                <tr>
                    <td align="center" style="background-color: #6f42c1; padding: 20px 0;">
                        <h1 style="color: white; margin: 0; font-size: 24px;">
                            📝 Appointment Updated
                        </h1>
                    </td>
                </tr>
                
                <!-- Body -->
                <tr>
                    <td style="padding: 30px;">
                        <div style="margin-bottom: 20px;">
                            <p>Dear ${object.customer_id.name},</p>
                            
                            <p>Your support appointment has been updated. Please review the current details below:</p>
                        </div>
                        
                        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Appointment Reference:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.name}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Date &amp; Time:</td>
                                <td style="padding: 10px; border: 1px solid #ddd; color: #6f42c1; font-weight: bold;">
                                    ${format_datetime(object.scheduled_date, object.customer_id.tz or 'UTC', 'full')}
                                </td>
                            </tr>
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Status:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${dict(object._fields['status'].selection)[object.status]}</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Technician:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.technician_id.name}</td>
                            </tr>
                            <tr style="background-color: #f8f9fa;">
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Duration:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.duration} hour(s)</td>
                            </tr>
                            % if object.location:
                            <tr>
                                <td style="padding: 10px; border: 1px solid #ddd; font-weight: bold;">Location:</td>
                                <td style="padding: 10px; border: 1px solid #ddd;">${object.location}</td>
                            </tr>
                            % endif
                        </table>
                        
                        <div style="background-color: #e7f1ff; padding: 15px; border-left: 4px solid #6f42c1; margin: 20px 0;">
                            <p style="margin: 0;"><strong>Please note:</strong></p>
                            <p style="margin: 5px 0 0 0;">If this update affects your schedule, please contact us to discuss any concerns.</p>
                        </div>
                        
                        <p>If you have any questions about these changes, please don't hesitate to contact us.</p>
                        
                        <p>Best regards,<br/>
                        Support Team</p>
                    </td>
                </tr>
                
                <!-- Footer -->
                <tr>
                    <td style="background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 11px;">
                        <p style="margin: 0;">
                            ${object.company_id.name}<br/>
                            % if object.company_id.phone:
                            Phone: ${object.company_id.phone}<br/>
                            % endif
                            % if object.company_id.email:
                            Email: ${object.company_id.email}
                            % endif
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
        </field>
    </record>
</odoo>